いつも忘れるやつだけメモしておく

## vim 置き換え  
tag 置き換え replace

単発置き換え  
`:%s/before/after/`

ファイル全体置き換え  
`:%s/before/after/g`

範囲置き換え  
`:1,100s/before/after/g`

結果にマッチした文字列を含める 。複数利用する場合は "\1" "\2" "\3" となる模様。  
`:%s/\(before\)/\1/g`

最小一致、最短一致。 ０回以上マッチ  

	:\{-\}
	
	# エスケープは最初の一文字だけでも有効な模様。 gvim で確認。
	:\{-}
	
	# yyy から xxx までの最小一致。上記の最小一致を表す文字列の前に任意の文字に一致の "." を入れている。
	:yyy.\{-\}xxx


最小一致、最短一致。　１回以上マッチ  
`:\{-1,\}`

マッチした文字列を利用する  
`&` or `\(target\)` から `\1` で指定可能
1. `:%s/target/&/g`  
2. `:%s/\(target\)/\1/g`

1 の方が入力は簡単だが、2 の方が細かい指定が可能。

コマンドモード中にレジスタの文字を貼り付ける。直近を貼り付ける場合は 0  
`Ctrl + r + [0 - 9]`

多分区切り文字は統一されていれば / 以外でも可。

### 使いそうな正規表現

	# HTML のルビタグをひらがな表記のほうに置き換える。
	:%s/<ruby>.\{-}<rt>\(.\{-}\)<\/rt><\/ruby>/\1/g

	# HTML タグを全て消去
	:%s/<.\{-}>//g

## vim 制御文字入力
tag 制御コード

`Ctrl + V -> Ctrl + 制御コード`

Ctrl + V を押したあと Ctrl + 制御コードについている文字を入力する。
"^I" を入力する場合は以下

`Ctrl + V -> Ctrl + I`

## ウィンドウ操作
tag window

ウィンドウ分割。縦、横。  
`:vs or <C-w> s`  
`:sp or <C-w> v`

分割内のフォーカス移動   
`<C-w> h`  
`<C-w> j`  
`<C-w> k`  
`<C-w> l`  

分割ウィンドウの移動  
`<C-w> H`  
`<C-w> J`  
`<C-w> K`  
`<C-w> L`  

次のウィンドウ、前のウィンドウへ  
`<C-w> w`   
`<C-w> W`   

分割ウィンドウのサイズ変更  
`:resize 10`  
`<C-w> +`  
`<C-w> -`  
`<C-w> =`  

## 再選択

一度解除した選択範囲を再選択する。覚えておくと何かと短縮になる。  
g キーから始まる機能は他にも結構あるみたい。

	gv

## ディレクトリ移動
tag カレントディレクトリ, directory

現在のカレントディレクトリを移動する  
gvim の場合、path は普通にウィンドウズの形式でOK  
`:cd path`

現在のカレントディレクトリを開いているファイルの場所にセットする  
`:cd %:h`

上記をデフォルトにする。  
.vimrc に記述推奨  
`:set autochdir`

## 文字コード（エンコード）を指定する

	Shift JIS で指定  
	:edit ++encoding=sjis

	cp932 でも同様の意味？ 因みに cp はコードページの略らしい  
	:e ++enc=cp932

	UTF-8 で指定  
	:edit ++encoding=utf-8
	
## ファイルのエンコードを設定する

	:set fileencoding=sjis
	:set fenc=utf-8
	
++encoding={encoding} では、ファイルを指定した文字コードで開く(ファイルは変更しない)  
fileencoding={encoding} はファイルの文字コードを指定したコードに設定する（ファイルを変更する)  
わかりにくいが、役割が全く異なるコマンドとなっている。

## 現在のエンコードの確認
`:se enc?`  
`:se fenc?`

## ファイルの改行コードを確認する

	:set fileformat?
	:set ff?

## ファイルの改行コードを変更する

	:set fileformat=dos
	:set ff=unix

指定できる改行コードは dos(CRLF), unix(LF), mac(CR) のいずれか。  
改行コードをセットしたらファイルは変更される。

## .vimrc の記述

	" .vimrc に追記すると、vim で使用する端末を bash に変更できる。(bash.exe が存在する前提)
	set shell=C:\PROGRA~1\Git\bin\bash.exe

### 端末に関して

Windows10 gvim で確認したところ、gvim を単体起動した場合の標準端末はコマンドプロンプト。  
また、gvim のコマンドモードから上記コマンドで端末をセットした場合は、上手く動作しない。  
.vimrc に記述して起動時から有効にしておく必要があるらしい。

Conemu から、gvim を起動した場合は上記のオプションがない場合でも bash が使用されていた。

## コマンドラインウィンドウ

キー入力 `q:` で開く。エディタ上と同じような操作感でコマンドを実行可能。  
過去に入力したコマンドが羅列される。実行したいコマンドの行にカーソルを合わせて `Enter` で実行。