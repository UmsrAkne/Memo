# patch

ファイルの変更を出力して、別のディレクトリに適用するコマンド。自分は git とセットで使用。  
まずは、 git diff コマンドの出力をファイルにリダイレクトする。拡張子は別に無くても可。わかれば良い。

	$ git diff > diff.patch
	
diff.patch が変更を保存したファイルなるので、それを変更を適用したいディレクトリに置く。

	$ patch -p1 < diff.patch
	
パッチコマンドに diff.patch を入力すれば適用できる。p1 オプションに関しては、diff.patch に記述されている

	--- dir0/dir1/dir2
	
のパスの部分を指定した数値分無視するオプションらしい。  
つまり p1 で指定した場合は 上記で言えば、dir0 が無視される。  
git diff の場合はパスの前に `a/ b/` といったディレクトリが入るため、1 を指定していると理解。  
これが 0 だと、git を使用した今回のケースでは動作しなかった。

### エラーが出た場合

適用の際にエラーが出たので書き留める。出たエラーが以下。

	patching file fileName
	Hunk #1 FAILED at 01 (different line nedings).

パッチの適用失敗。リポジトリに `.orig .rej` ファイルが生成された。  
今回のケースでは、適用先とパッチファイルの改行コードの違いが問題だったらしいが、改行コードの修正では問題を解決できず。

	$ patch -p1 --binary < diff.patch
	
で解決。 `--binary` は、ファイルをバイナリモードで読み書きすることのこと。  
バイナリファイルで読み書きは理解できるけど、何故これで改行コードの問題が解決すのかは不明。