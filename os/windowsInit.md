# Windows 10 を最初からセットアップするときのメモ

## Windows のアップデート

ネットが開通したら、まず最初に Windows のバージョンを最新版にする。  
ウェブ検索から MS 公式ページに飛び、`今すぐアップデート` ボタンを押す。

## アプリ導入

無事にアップデートが完了したら `winget.md` を参照して、CLI からインストール可能なものは `winget` で導入する。

`winget` で無理なものは、手動でインストール。秀丸ファイラとかはないっぽいので、公式からダウンロード。

インストールせずに使えるソフトは、専用のスペースに隔離してあるので、別の PC からコピってくる。

前環境のユーザフォルダに置いてある以下のファイルも持ってくる。絶対に１からやろうとするな。

    .bashrc
    .gvimrc
    .ideavimrc
    .vimrc
    .vsvimrc
    .bash_profile
    .gitconfig

個人的なファイルだが、同じフォルダに置かれている `shellScripts` も一緒にコピー。

## アプリ設定

一通りのインストールが済んだら、次に最低限の設定を施していく。

２，３項目設定すれば完了する場合は別として、通常は前環境から設定ファイルを出力して適用する。

## ChangeKey

非インストールソフトを集めたフォルダに入っている。

メニューバーから設定ファイルを出力可能。読み込みも同じくメニューバーから。

## ConEmu 

導入後に以下の設定を行う。

    Setting -> General -> Choose your startup task -> Bash::Git bash
        Git bash がない場合は Git をインストールしているフォルダにある bash.exe を直接指定する。

    Setting -> General -> Minimize/Restore hotkey : -> 消去 or 当たり障りの無いキーを割り当てる
        Ctrl + @ で ConEmu が立ち上がってくる。他のアプリと衝突するため、このキーは無効にした方が良い。

導入後に気がついたが、設定ファイルの出力が可能であるようだ。そっちのほうが早そう。

## VSCode

他の PC から設定を持ってこられる場合は以下のロケーションに設定ファイルを置く。

設定ファイルは以下

    %APPDATA%\Code\User\settings.json

プラグインは以下に保存されている。

    %USERPROFILE%\.vscode\extensions

デフォルトターミナルの切り替え。コマンドパレットを開いて以下を入力することで選択可能

    > Terminal Select Default Profile -> Git Bash

## Google 日本語入力

設定ファイルをエクスポートするには

    IME のボタンを右クリック -> プロパティ -> キー設定 -> キー設定の選択 -> 編集 -> 新しいページの左下のプルダウン -> エクスポート

インポートも同様の場所に配置されている。

### デフォルト IME の切り替え

デフォルト設定を MSIMl Eからグーグル日本語入力に切り替える

    設定 -> 時刻と言語 -> 言語 -> 日本語の項目をクリック -> オプション 
    "言語オプション : 日本語" のページに移動 -> キーボードの追加 -> グーグル日本語入力を追加 -> MicrosoftIME を削除

## Git

以下のコマンドでコミット編集用のアプリを指定する。

エディタのロケーションが変わっている場合は、指定しなおす。

ウィンドウズでのファイル指定だが、バックスラッシュではなくスラッシュで通る。

    > git config --global core.editor 'C:/NonRegistry/vim82/gvim.exe'

## Vivaldi

アドオンを導入する。

    AdBlock
    uBlacklist
    Vimium
    Stylus

履歴はデフォルトでは 3ヶ月 で消滅する設定なので、必要なら変更する。

Stylus の css には以下の内容を記述。画像全消し。

    img,
    iframe {
        visibility: hidden !important;
        display: none !important;
    }

### データの復元

復元元のメニュー

    File -> ブックマークのエクスポート

復元先のメニュー

    File -> アプリケーションまたはファイルからインポート -> エクスポートしたファイルを選択

ブックマークの画面には `インポートしたブックマーク` というフォルダに入れられて追加される。

## AutoHotkey

アプリそのものは別途インストールして、作ってあるスクリプトをスタートアップに加える。

エクスプローラーのパスバーに以下のアドレスを入力する。

    shell:startup

スタートアップフォルダが開くので、.ahk へのショートカットを追加する。

今回、`winget` から AHK を導入し、スクリプトを起動したところ、警告が出た。  
詳しい文面は省くが、AHK のバージョンの違いに関する警告っぽい。  
そのまま進むと、アプリの方で自動的に必要なバージョンをインストールしてくれた。

## Windows 自体の設定

設定 -> システム -> マルチタスク

    [ ] ウィンドウをスナップしたときに横に配置できるものを表示する

チェックを外す。Windowsキーでウィンドウを整列した際、画面半分にウィンドウのサムネイルが並ぶ機能をオフにする。

## Windows のウェブ検索を無効化

    Windows Registry Editor Version 5.00

    [HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Search]
    "CortanaConsent"=dword:00000000
    "BingSearchEnabled"=dword:00000000

新規テキストファイルを作成し、上記をコピペ。`xxx.reg` とか適当な名前をつけて保存してダブルクリック。